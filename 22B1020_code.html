{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "27b63055-6bf5-4108-a530-41e196e9a6e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import re"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "928c3b3e-e63b-4ee3-bd3a-f9ea91553c85",
   "metadata": {},
   "source": [
    "# Part1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a2ace32d-c2e1-4fda-a570-35a00f4efc0e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\harsh\\AppData\\Local\\Temp\\ipykernel_21228\\3548173870.py:2: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.\n",
      "  df_loans['nextPaydate'] = pd.to_datetime(df_loans['nextPaydate'])\n"
     ]
    }
   ],
   "source": [
    "df_loans = pd.read_csv('data.csv')\n",
    "df_loans['nextPaydate'] = pd.to_datetime(df_loans['nextPaydate'])\n",
    "df_loans['maturityDate'] = df_loans['nextPaydate'] + pd.to_timedelta(df_loans['remTerm'], unit='D')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bc5ad7b1-79e4-4fb0-ab64-0086725615eb",
   "metadata": {},
   "source": [
    "# Part2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1df95f13-eab4-49e1-9496-1e1bee6718ac",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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icjOztaY17RpU50VV1RSUlJgZWWF5ORknr9Dhc5t4k59l6Bzt+b46bsEInoPFfT3t9YjO//88w969+6N27dv4785SaFQICsrS/tqiYiIiAqJ1mHn888/R7169bBz506UKVMGCoWiMOoiIiIi0gmtw861a9ewdetWVKxYsTDqISIiItIpra/GatCgAa5fv14YtRARERHpnNYjOyNHjsTYsWMRHx8PLy8vGBsba8yvUaOGzoojIiIieldahx1/f38AwODBg6VpCoUCQgieoExERETFzlt9NxYRERFRSaF12HF1dS2MOoiIiIgKhdZhJ0dUVBRiYmKQnp6uMf3jjz9+56KIiIiIdEXrsPPvv/+iS5cuuHjxonSuDgDpfjs8Z4eIiIiKE60vPR89ejTc3d2RmJgIc3NzREZG4siRI6hXrx4OHTpUCCUSERERvT2tR3bCw8Nx4MABlC5dGgYGBjAwMEDjxo0xe/ZsjBo1CmfPni2MOomIiIjeitYjO1lZWShVqhQAoHTp0oiNjQWgPnE5Ojpat9URERERvSOtR3aqV6+O8+fPw93dHQ0aNMDcuXNhYmKClStXokKFCoVRIxEREdFb0zrsTJo0CampqQCAGTNmoEOHDmjSpAns7Ozw22+/6bxAIiIionehddjx9fWV/l2xYkVcuXIFjx49go2NDb8BnYiIiIqdt77PDgDcvXsXAFCuXDmdFENERESka1qfoJydnY0ZM2bAysoKrq6ucHV1hbW1Nb755htkZ2cXRo1EREREb03rkZ2vv/4aq1evxpw5c9CoUSMAwNGjRzFt2jS8ePEC3377rc6LJCIiInpbWoeddevW4eeff9b4WogaNWqgbNmy+OKLLxh2iIiIqFjR+jDWo0eP4OHhkWu6h4cHHj16pJOiiIiIiHRF67BTs2ZN/Pjjj7mm//jjj6hZs6ZOiiIiIiLSFa0PY82dOxd+fn7Yt28fvL29Aai/QuLOnTvYtWuXzgskIiIiehdaj+w0a9YMV69eRZcuXZCUlISkpCR07doV0dHRaNKkSWHUSERERPTW3uo+O87OzrlORL579y6GDRuGlStX6qQwIiIiIl3QemQnPw8fPsTq1at1tToiIiIindBZ2CEiIiIqjhh2iIiISNYYdoiIiEjWCnyCcteuXV87Pykp6V1rISIiItK5AocdKyurN87v37//OxdERERE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jfXlXK2Vs0xelEollEqlVnUSERFRyaR12BkzZozG84yMDJw9exZhYWEYP378OxeUnZ2NtLQ01K1bF8bGxti/fz/8/f0BANHR0YiJiYG3tzcAwNvbG99++y0SExPh4OAAANi7dy9UKhU8PT3fuRYiIiIq+bQOO6NHj85z+tKlS3Hq1Cmt1hUcHIx27dqhfPnyePLkCTZu3IhDhw5hz549sLKywpAhQxAUFARbW1uoVCqMHDkS3t7eaNiwIQCgTZs28PT0RL9+/TB37lzEx8dj0qRJCAgI4MgNERERAXiLsJOfdu3aITg4WKsTmBMTE9G/f3/ExcXBysoKNWrUwJ49e9C6dWsAwMKFC2FgYAB/f3+kpaXB19cXy5Ytk15vaGiI0NBQDB8+HN7e3rCwsMCAAQMwY8YMXW0WERUSXoJPREVFZ2Fn69atsLW11eo1q1evfu18U1NTLF26FEuXLs13GVdXV+zatUur9yUiIqL3h9Zhp3bt2honKAshEB8fj/v372uMuhAREREVB1qHnc6dO2s8NzAwgL29PZo3bw4PDw9d1UVERESkE1qHnalTpxZGHURERESFQu83FSQiIiIqTAUe2TEwMHjtzQQBQKFQIDMz852LIiIiItKVAoedP//8M9954eHhWLJkCbKzs3VSFBEREZGuFDjsdOrUKde06OhoTJw4ETt27ECfPn14fxsiIiIqdt7qnJ3Y2FgMHToUXl5eyMzMxLlz57Bu3Tq4urrquj4iIiKid6JV2ElOTsaECRNQsWJFREZGYv/+/dixYweqV69eWPURERERvZMCH8aaO3cuvvvuOzg5OWHTpk15HtYiIiIiKm4KHHYmTpwIMzMzVKxYEevWrcO6devyXO6PP/7QWXFERERE76rAYad///5vvPSciIiIqLgpcNgJCQkpxDKIiIiICgfvoExERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLKm17Aze/ZsfPjhhyhVqhQcHBzQuXNnREdHayzz4sULBAQEwM7ODpaWlvD390dCQoLGMjExMfDz84O5uTkcHBwwfvx4ZGZmFuWmEBERUTGl17Bz+PBhBAQE4J9//sHevXuRkZGBNm3aIDU1VVomMDAQO3bswJYtW3D48GHExsaia9eu0vysrCz4+fkhPT0dx48fx7p16xASEoIpU6boY5OIiIiomFEIIYS+i8hx//59ODg44PDhw2jatCmSk5Nhb2+PjRs3olu3bgCAK1euoGrVqggPD0fDhg2xe/dudOjQAbGxsXB0dAQArFixAhMmTMD9+/dhYmLyxvdNSUmBlZUVkpOToVKpCnUbidwm7tR3CTp3a46f1q9hH4joXRX093exOmcnOTkZAGBrawsAOH36NDIyMuDj4yMt4+HhgfLlyyM8PBwAEB4eDi8vLynoAICvry9SUlIQGRmZ5/ukpaUhJSVF40FERETyVGzCTnZ2NsaMGYNGjRqhevXqAID4+HiYmJjA2tpaY1lHR0fEx8dLy7wadHLm58zLy+zZs2FlZSU9XFxcdLw1REREVFwUm7ATEBCAS5cuYfPmzYX+XsHBwUhOTpYed+7cKfT3JCIiIv0w0ncBADBixAiEhobiyJEjKFeunDTdyckJ6enpSEpK0hjdSUhIgJOTk7RMRESExvpyrtbKWea/lEollEqljreCiIiIiiO9juwIITBixAj8+eefOHDgANzd3TXm161bF8bGxti/f780LTo6GjExMfD29gYAeHt74+LFi0hMTJSW2bt3L1QqFTw9PYtmQ4iIiKjY0uvITkBAADZu3Ii//voLpUqVks6xsbKygpmZGaysrDBkyBAEBQXB1tYWKpUKI0eOhLe3Nxo2bAgAaNOmDTw9PdGvXz/MnTsX8fHxmDRpEgICAjh6Q0RERPoNO8uXLwcANG/eXGP62rVrMXDgQADAwoULYWBgAH9/f6SlpcHX1xfLli2TljU0NERoaCiGDx8Ob29vWFhYYMCAAZgxY0ZRbQYREREVY3oNOwW5xY+pqSmWLl2KpUuX5ruMq6srdu3apcvSiIiKBO83RFT4is3VWERERESFgWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkTa9h58iRI+jYsSOcnZ2hUCiwbds2jflCCEyZMgVlypSBmZkZfHx8cO3aNY1lHj16hD59+kClUsHa2hpDhgzB06dPi3AriIiIqDjTa9hJTU1FzZo1sXTp0jznz507F0uWLMGKFStw4sQJWFhYwNfXFy9evJCW6dOnDyIjI7F3716EhobiyJEjGDZsWFFtAhERERVzRvp883bt2qFdu3Z5zhNCYNGiRZg0aRI6deoEAFi/fj0cHR2xbds29OzZE5cvX0ZYWBhOnjyJevXqAQB++OEHtG/fHvPnz4ezs3ORbQsREREVT8X2nJ2bN28iPj4ePj4+0jQrKys0aNAA4eHhAIDw8HBYW1tLQQcAfHx8YGBggBMnTuS77rS0NKSkpGg8iIiISJ6KbdiJj48HADg6OmpMd3R0lObFx8fDwcFBY76RkRFsbW2lZfIye/ZsWFlZSQ8XFxcdV09ERETFhV4PY+lLcHAwgoKCpOcpKSkMPEXAbeJOfZegc7fm+Om7BCIieoNiO7Lj5OQEAEhISNCYnpCQIM1zcnJCYmKixvzMzEw8evRIWiYvSqUSKpVK40FERETyVGzDjru7O5ycnLB//35pWkpKCk6cOAFvb28AgLe3N5KSknD69GlpmQMHDiA7OxsNGjQo8pqJiIio+NHrYaynT5/i+vXr0vObN2/i3LlzsLW1Rfny5TFmzBjMnDkTlSpVgru7OyZPngxnZ2d07twZAFC1alW0bdsWQ4cOxYoVK5CRkYERI0agZ8+evBKLiIiIAOg57Jw6dQotWrSQnuecRzNgwACEhITgyy+/RGpqKoYNG4akpCQ0btwYYWFhMDU1lV6zYcMGjBgxAq1atYKBgQH8/f2xZMmSIt8WIiIiKp70GnaaN28OIUS+8xUKBWbMmIEZM2bku4ytrS02btxYGOURERGRDBTbc3aIiIiIdIFhh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZI1hh4iIiGSNYYeIiIhkjWGHiIiIZE2vXxdBRESUw23iTn2XoHO35vjpuwQCR3aIiIhI5hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWGHaIiIhI1hh2iIiISNYYdoiIiEjWjPRdABEREb3kNnGnvkvQuVtz/PT6/hzZISIiIlmTTdhZunQp3NzcYGpqigYNGiAiIkLfJREREVExIIvDWL/99huCgoKwYsUKNGjQAIsWLYKvry+io6Ph4OCg19o4HElERKRfshjZ+f777zF06FAMGjQInp6eWLFiBczNzbFmzRp9l0ZERER6VuJHdtLT03H69GkEBwdL0wwMDODj44Pw8PA8X5OWloa0tDTpeXJyMgAgJSVF5/Vlpz3T+Tr17W37xF6osQ9q7IMa+/ASe6HGPmi/XiHE6xcUJdy9e/cEAHH8+HGN6ePHjxf169fP8zVTp04VAPjggw8++OCDDxk87ty589qsUOJHdt5GcHAwgoKCpOfZ2dl49OgR7OzsoFAo9FjZ20tJSYGLiwvu3LkDlUql73L0hn1QYx9eYi/U2Ac19uElOfRCCIEnT57A2dn5tcuV+LBTunRpGBoaIiEhQWN6QkICnJyc8nyNUqmEUqnUmGZtbV1YJRYplUpVYndaXWIf1NiHl9gLNfZBjX14qaT3wsrK6o3LlPgTlE1MTFC3bl3s379fmpadnY39+/fD29tbj5URERFRcVDiR3YAICgoCAMGDEC9evVQv359LFq0CKmpqRg0aJC+SyMiIiI9k0XY+eSTT3D//n1MmTIF8fHxqFWrFsLCwuDo6Kjv0oqMUqnE1KlTcx2ee9+wD2rsw0vshRr7oMY+vPQ+9UIhxJuu1yIiIiIquUr8OTtEREREr8OwQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERERayc7O1ncJWmHYoRK30xIVhbS0NH2XUGwkJCQgNjZW32XoXUxMDC5cuKDvMvTuypUrWLx4sb7L0ArDznssOTkZAGBgYPDeB57Y2Fj89ddf+O2333DmzBl9l6M3N2/exMKFC/HVV19hx44d+i5Hb6KiotCyZUscPXpU36Xo3dmzZ1G/fn1cuXJF36Xo1YULF9CsWTOsWrUKjx490nc5enPx4kXUqlULY8eOxYkTJ/RdToEx7LynoqKi4OrqilmzZgF4vwPPxYsX0bRpU8ycORNffvklunTpgp07d+q7rCJ34cIFNG3aFKGhoTh8+DA6deqE7du367ssvZg/fz7Cw8MxcOBAhIeH67scvTl//jyaNGmCLl26oGXLlvouR2+uX78OHx8fdOvWDfPnz4etra2+S9KL8+fPo379+vjkk0/QrFkzhIaGAigZRwcYdt5Dd+/eRd++feHo6IgFCxZgzpw5AN7PwHPjxg20a9cO3bp1w969exEaGor27dtj7dq1SE1Nxftyg/GrV6/Cz88P/fr1w+7duxEaGop27drh7t27+i5NL5o0aYIvv/wSzZs3R8eOHfF///d/+i6pyEVGRqJJkyYYOXIkFi1ahKysLJw7dw7Hjx9HZGSkvssrUqGhoWjdujXmzZsHQ0NDrFixAhMnTsTy5ctx9epVfZdXJM6ePYsmTZpg7NixWLduHT788EP89NNPSE5OhoGBQfH/v1LQeyUrK0ssWrRIdO3aVRw4cEDMmTNHqFQqMXv2bI1l3gdpaWkiMDBQdO/eXaSnp0vTV69eLZydnUVKSooeqys6aWlponfv3mLAgAEiMzNTmu7v7y/69esnBg8eLH744Qfx6NEjPVZZtDZv3iw++ugj8ezZM9GhQwfh4OAgoqKixKRJk8TmzZv1XV6he/Hihahdu7YoU6aMiIuLE0II0blzZ1G7dm1ha2srLCwsxNy5c/VcZdEZNGiQGDRokBBCiCZNmogPP/xQtGrVSlhbW4t27dqJXbt26bnCwpWQkCDMzMzEuHHjpGkxMTGiSpUqYvr06XqsrOA4svOeMTAwQPv27dGtWze0aNECw4YNQ3BwMGbPnv3ejfAYGBigYsWKaNKkCYyNjaW/TFq2bAljY2PpnCa5MzExwVdffYU+ffrA0NAQADBr1iz8+eefyM7OhqmpKUaNGoUpU6boudKiU6dOHZiYmMDMzAw7duxAixYtULt2bSxfvhx16tTRd3mFTqlU4vvvv4dKpUJgYCDq1q2LZ8+eYcmSJdizZw9mz56NCRMmYMWKFfoutVDl/J/g4uICY2NjbNu2Daampti5cyf27duHiIgIPHnyBGvWrNFzpYXL2NgYYWFhmDdvnjTN0dERtWvXxt9//y1NE8V5dEfPYYv0JDs7W/r3/fv3c43wZGZmiu3bt4v79+/rq8QiERsbK/07pyf37t0Trq6u4tatW9K0y5cv66U+fbhw4YLw8fERu3btkrZ/69atwsjISFy5ckXP1RWdmjVriujoaCGEEL179xYWFhbCxsZGnDx5Us+VFa5X/284ePCgcHJyEs2aNdP4WRFCiLFjxwovLy/x8OFDjdfIUVhYmFAoFKJJkybi008/1Zh34sQJoVAoxOnTp/VUXdHLGf2/dOmSUCqVYvXq1Xqu6M2M9B22qPDFxsbi3r17ePjwIXx8fGBgYAADAwNkZmbCyMgIpUuXxuDBgwGo/6IXQuDhw4dYvHgxYmJi9Fy9buX04sGDB/D19YWjoyMASL3Izs5GSkoKnj17BhMTEygUCgQHB+O7777D48ePoVKpoFAo9LwV7y6/fQIAvLy8sH79epQpU0Za3sDAAJ6enihdurS+Si4Ur/ahdevWUCgUMDAwwPPnz2FjY4MnT55g1KhROHToEA4cOIAFCxagYcOGOH78OOrXr6/v8nXq1V60atUKANC8eXOEhoYiKioK9vb2GsubmprC3NwcNjY2sviZyPHfnw0A8PX1xYQJEzB37lxYW1sjNTUVFhYWAAAbGxvUrl0bVlZW+ixb5/L7PyI7O1s6R8fd3R0dOnTA7t270bt3byiVyuK7L+g7bVHhOn/+vHBxcRGenp7CyMhI1K5dWyxfvlw8efJECCE0ztG4f/++mD17tlAoFLL8CzavXixbtkzqRc5fKzdu3BBlypQRjx8/FtOmTROlSpUSJ06c0GfpOvWmfUIIkesv9fHjx4v27dvL6jym/PqQnJwshFCPXJiZmQlnZ2fpr/a0tDTRt29facRHLvLqxdKlS6VevHpOW47PP/9cDB48WKSlpclmZCe//yNSU1PF/fv3xWeffSYMDQ3F1KlTxY0bN8TTp0/FlClTRNWqVUVCQoK+y9eZN/0f8ep5nRs2bBBKpVJEREToq9wCYdiRsfv374uqVauKCRMmiJs3b4rExETRq1cv0aBBAzFmzBjpF9erO26/fv2ESqUSkZGR+iq7UBS0F0KoT8arUaOG6N69uzAxMRGnTp3SY+W6pU0fhFAf5ps0aZKwtrYWFy9e1FPVuve6PowePVo8e/ZM/PXXX8LPz0+cPXtW3+UWqrfZJyZPnixsbGxk9f9Efn348MMPRVBQkEhNTRVPnz4V33zzjVAqlcLV1VXUrFlTlClTRpw5c0bf5etMQfeHV/9Qrl27tujXr5/IysoqtsGXYUfGLl68KNzc3MT58+elaWlpaWLKlCmifv364uuvvxbPnz8XQqj/kv/ll1+Eo6OjLI89a9OLS5cuCYVCIczMzMS5c+f0VXKh0KYPp06dEn379hXu7u6y+4X/uj7Uq1dPusLk1dEuudJmn4iIiBDdu3cX5cqVe+/2icmTJ4sXL14IIYQ4d+6c+P3338Uff/whbt++ra+SC4U2+0OOxYsXi2vXrhV1qVrh1VgylnPOSc55N5mZmTAxMcHkyZPRrFkz7Ny5EydPngQAKBQKNGrUCCdOnJDl1Sba9KJs2bIYO3YsTp8+jZo1a+qzbJ3Tpg9OTk7o0aMH9u/fj1q1aumxat17XR9atGiB33//HUePHoWlpWXxvsJEB7TZJ8qUKYMePXrg0KFD790+sX37dumOwTVr1kTXrl3RpUsXlC9fXp9l65w2+0NmZiYAYNSoUahYsaLeai4IhZD7T/J7LC0tDY0bN4aTkxO2bdsGQ0ND6URcIQRq1qyJ2rVrY926dRBCFN8Ty3RAm17kLK9UKvVcte4VpA+1atXC+vXr9V1qodJ2f5Az7hNq3CfU5NoHjuzIVHZ2NpRKJdauXYsjR45g+PDhACDtsAqFAh9//DESExMBQNZBR5te5GR/OQadgvbh/v37eq60cGn7syFn3CfUuE+oybkPDDsyZWBggKysLFSvXh3r1q3Dpk2b0L9/fyQkJEjL3Lx5EzY2NsjKytJjpYVPm17I+WaK3CfU2IeX2As19kFNzn3gYSyZyLn3QY6cYcenT58iLS0N586dQ+/eveHq6gpbW1vY2dnhr7/+Qnh4OLy8vPRYue6xF2rsgxr78BJ7ocY+qL1PfeDITgn34MEDAC8TOQBkZWXByMgIt27dQuXKlXHy5Em0atUKkZGRaN++PcqWLQsHBwdERESUuB32ddgLNfZBjX14ib1QYx/U3ss+FOm1X6RT0dHRolSpUmLo0KHStJx7H8TExIjSpUuLIUOGiOzsbGl6zj0Q5PZln+yFGvugxj68xF6osQ9q72sfOLJTgkVFRcHMzAwXL17EZ599BgAwNDREeno6tm/fjn79+uGnn36CQqGQvuAxh9xOSGYv1NgHNfbhJfZCjX1Qe1/7wLBTgimVSlhbW6Nz584IDw/H559/DkB9n4ROnTrh+++/z3dnLck7bV7YCzX2QY19eIm9UGMf1N7XPvCLQEswLy8v1K1bF59++ilMTEwQEhKCoKAgJCcno379+hg8eDCMjY31XWaRYC/U2Ac19uEl9kKNfVB7b/ug7+No9PZSU1NFjRo1xNmzZ0VqaqpYuXKlsLOzEwqFQly4cEEIofn9JXLGXqixD2rsw0vshRr7oPa+9oGHsUqojIwMKJVKODk54enTpzA3N8f+/fuRkZGBihUr4ueffwaAXMORcsReqLEPauzDS+yFGvug9j73gYexSoDY2FicOXMG6enpcHNzQ506daRhxrp16+L69etYuXIljhw5gh07duDixYuYM2cOjIyMsGDBAj1Xr1vshRr7oMY+vMReqLEPauzDf+h7aIle78KFC6JChQqifv36onTp0qJevXpiy5Yt0vxp06YJhUIh3N3dpW8rf/z4sVi2bJm4ceOGvsouFOyFGvugxj68xF6osQ9q7ENuDDvF2PXr10W5cuXEl19+KZKSksSpU6fEgAEDxODBg0VGRoYQQoiMjAzxxRdfiIiICCGEPO6HkBf2Qo19UGMfXmIv1NgHNfYhbww7xVRaWpoICgoSPXr0EGlpadL01atXCzs7O/HgwQM9Vle02As19kGNfXiJvVBjH9TYh/zxnJ1iKjs7G+XKlUPVqlVhYmIifePsRx99BEtLS2RkZOT5mle/50Qu2As19kGNfXiJvVBjH9TYh/wx7BRTpqam6Ny5M9zd3TWmW1tbw9jYWGOnPXv2LGrXri3bHZa9UGMf1NiHl9gLNfZBjX3I3/uxlSVEXFwcIiIiEBYWhuzsbGmHzcrKku5cmZycjMePH0uvmTJlClq1aoWHDx9CyOgL7NkLNfZBjX14ib1QYx/U2IcC0sexM8rt/PnzwtXVVVSuXFlYWVkJDw8PsXHjRvHw4UMhxMsTyKKjo4W9vb149OiR+Oabb4SZmZk4deqUPkvXOfZCjX1QYx9eYi/U2Ac19qHgGHaKgcTEROHh4SG++uorcePGDXHv3j3xySefiKpVq4qpU6eKxMREadmEhARRu3Zt8cknnwgTExPZ7bDshRr7oMY+vMReqLEPauyDdhh2ioHIyEjh5uaWawecMGGC8PLyEnPnzhWpqalCCCGioqKEQqEQZmZm4uzZs3qotnCxF2rsgxr78BJ7ocY+qLEP2uE5O8VARkYGMjMz8ezZMwDA8+fPAQBz5sxBixYtsHz5cly/fh0AYGNjgy+++AJnzpxBrVq19FVyoWEv1NgHNfbhJfZCjX1QYx+0oxDifTk7qXirX78+LC0tceDAAQBAWloalEolAODDDz9ExYoVsWnTJgDAixcvYGpqqrdaCxt7ocY+qLEPL7EXauyDGvtQcBzZ0YPU1FQ8efIEKSkp0rSffvoJkZGR6N27NwBAqVQiMzMTANC0aVOkpqZKy8pph2Uv1NgHNfbhJfZCjX1QYx/eDcNOEYuKikLXrl3RrFkzVK1aFRs2bAAAVK1aFYsXL8bevXvRvXt3ZGRkSPc/SExMhIWFBTIzM2V1mSB7ocY+qLEPL7EXauyDGvugA3o7W+g9FBkZKezs7ERgYKDYsGGDCAoKEsbGxuLMmTNCCCFSU1PF9u3bRbly5YSHh4fo3Lmz6NGjh7CwsBAXL17Uc/W6xV6osQ9q7MNL7IUa+6DGPugGz9kpIo8ePUKvXr3g4eGBxYsXS9NbtGgBLy8vLFmyRJr25MkTzJw5E48ePYKpqSmGDx8OT09PfZRdKNgLNfZBjX14ib1QYx/U2Afd4ddFFJGMjAwkJSWhW7duAF5+H4m7uzsePXoEABDqWwGgVKlS+O677zSWkxP2Qo19UGMfXmIv1NgHNfZBd9iNIuLo6Ihff/0VTZo0AaC+lTcAlC1bVtopFQoFDAwMNE5Ay7ndt5ywF2rsgxr78BJ7ocY+qLEPusOwU4QqVaoEQJ26jY2NAahTeWJiorTM7Nmz8fPPP0tn1Mt1p2Uv1NgHNfbhJfZCjX1QYx90g4ex9MDAwABCCGmHzEnoU6ZMwcyZM3H27FkYGb0fHw17ocY+qLEPL7EXauyDGvvwbjiyoyc554UbGRnBxcUF8+fPx9y5c3Hq1CnUrFlTz9UVLfZCjX1QYx9eYi/U2Ac19uHtMQbqSU4qNzY2xqpVq6BSqXD06FHUqVNHz5UVPfZCjX1QYx9eYi/U2Ac19uHtcWRHz3x9fQEAx48fR7169fRcjX6xF2rsgxr78BJ7ocY+qLEP2uN9doqB1NRUWFhY6LuMYoG9UGMf1NiHl9gLNfZBjX3QDsMOERERyRoPYxEREZGsMewQERGRrDHsEBERkawx7BAREZGsMewQERGRrDHsEBERkawx7BCRTt26dQsKhQLnzp3TdylFql+/fpg1a5a+y8ilIJ9HWFgYatWqhezs7KIrjKgIMewQlTADBw6EQqHA559/nmteQEAAFAoFBg4cWOD16TqcuLi4IC4uDtWrVwcAHDp0CAqFAklJSe+8boVCIT0sLCxQqVIlDBw4EKdPn9Z6Xc2bN8eYMWPeuSYAOH/+PHbt2oVRo0ZprF+hUGDOnDm5lvfz84NCocC0adN08v45Bg4ciM6dO2v9urZt28LY2BgbNmzQaT1ExQXDDlEJ5OLigs2bN+P58+fStBcvXmDjxo0oX7683upKT0+HoaEhnJycCu0bmNeuXYu4uDhERkZi6dKlePr0KRo0aID169cXyvsVxA8//IDu3bvD0tJSY7qLiwtCQkI0pt27dw/79+9HmTJlirDCNxs4cCCWLFmi7zKICgXDDlEJVKdOHbi4uOCPP/6Qpv3xxx8oX748ateurbFsWFgYGjduDGtra9jZ2aFDhw64ceOGNN/d3R0AULt2bSgUCjRv3hxA3iMfnTt31hg1cnNzwzfffIP+/ftDpVJh2LBhGiNFt27dQosWLQAANjY20qjT+vXrYWdnh7S0tFzr79ev32u33draGk5OTnBzc0ObNm2wdetW9OnTByNGjMDjx48BAA8fPkSvXr1QtmxZmJubw8vLC5s2bZLWMXDgQBw+fBiLFy+WRopu3boFALh06RLatWsHS0tLODo6ol+/fnjw4EG+9WRlZWHr1q3o2LFjrnkdOnTAgwcPcOzYMWnaunXr0KZNGzg4OGgs+/jxY/Tv3x82NjYwNzdHu3btcO3aNWl+SEgIrK2tsWfPHlStWhWWlpZo27Yt4uLiAADTpk3DunXr8Ndff0nbdOjQIen1//77L1q0aAFzc3PUrFkT4eHhGu/fsWNHnDp1SmPfIJILhh2iEmrw4MFYu3at9HzNmjUYNGhQruVSU1MRFBSEU6dOYf/+/TAwMECXLl2k8zMiIiIAAPv27UNcXJxGgCqI+fPno2bNmjh79iwmT56sMc/FxQW///47ACA6OhpxcXFYvHgxunfvjqysLGzfvl1aNjExETt37sTgwYO1en8ACAwMxJMnT7B3714A6lGuunXrYufOnbh06RKGDRuGfv36Sdu6ePFieHt7Y+jQoYiLi0NcXBxcXFyQlJSEli1bonbt2jh16hTCwsKQkJCAHj165PveFy5cQHJycp5fyGhiYoI+ffpofE4hISF5buPAgQNx6tQpbN++HeHh4RBCoH379sjIyJCWefbsGebPn49ffvkFR44cQUxMDMaNGwcAGDduHHr06CEFoLi4OHz00UfSa7/++muMGzcO586dQ+XKldGrVy9kZmZK88uXLw9HR0f83//9X0HbTlRiFM44MxEVur59+yI4OBi3b98GABw7dgybN2/W+GseAPz9/TWer1mzBvb29oiKikL16tVhb28PALCzs4OTk5PWdbRs2RJjx46VnueMkACAoaEhbG1tAQAODg6wtraW5vXu3Rtr165F9+7dAQC//vorypcvL40sacPDw0PjvcuWLSuFAAAYOXIk9uzZg//973+oX78+rKysYGJiAnNzc41t/vHHH1G7dm2NE43XrFkDFxcXXL16FZUrV8713rdv34ahoWGukZocgwcPRpMmTbB48WKcPn0aycnJ6NChg8b5OteuXcP27dtx7NgxKaBs2LABLi4u2LZtm9SjjIwMrFixAh988AEAYMSIEZgxYwYAwNLSEmZmZkhLS8vzcxw3bhz8/PwAANOnT0e1atVw/fp1qXcA4OzsLO1PRHLCsENUQtnb28PPzw8hISEQQsDPzw+lS5fOtdy1a9cwZcoUnDhxAg8ePJBGdGJiYqSTiN9FXiMaBTF06FB8+OGHuHfvHsqWLYuQkBDp5Gtt5Xyfcc5rs7KyMGvWLPzvf//DvXv3kJ6ejrS0NJibm792PefPn8fBgwdznXsDADdu3Mgz7Dx//hxKpTLfumvWrIlKlSph69atOHjwIPr165frfKbLly/DyMgIDRo0kKbZ2dmhSpUquHz5sjTN3NxcCjoAUKZMGSQmJr52m3LUqFFD43WAejTt1bBjZmaGZ8+eFWh9RCUJww5RCTZ48GCMGDECALB06dI8l+nYsSNcXV2xatUqODs7Izs7G9WrV0d6evpr121gYCCFiByvHlLJYWFh8Va1165dGzVr1sT69evRpk0bREZGYufOnW+1rpxAkHP+0bx587B48WIsWrQIXl5esLCwwJgxY964zU+fPkXHjh3x3Xff5ZqX3wnFpUuXxrNnz5Ceng4TE5M8lxk8eDCWLl2KqKgo6VDa2zA2NtZ4rlAocn1GBXltTjD776Xmjx49kkb6iOSE5+wQlWBt27ZFeno6MjIy4Ovrm2v+w4cPER0djUmTJqFVq1aoWrWqdBJvjpxf0FlZWRrT7e3tpZNfc+ZfunRJ6xrzWz8AfPrppwgJCcHatWvh4+MDFxcXrdcPAIsWLYJKpYKPjw8A9SG9Tp06oW/fvqhZsyYqVKiAq1ev5qrrvzXVqVMHkZGRcHNzQ8WKFTUe+YW6WrVqAQCioqLyra937964ePEiqlevDk9Pz1zzq1atiszMTJw4cUKalvPZ5bV8fvLapoJ68eIFbty4kesEdyI5YNghKsEMDQ1x+fJlREVFwdDQMNd8Gxsb2NnZYeXKlbh+/ToOHDiAoKAgjWUcHBxgZmYmnYybnJwMQH0uzs6dO7Fz505cuXIFw4cPf6t75bi6ukKhUCA0NBT379/H06dPpXm9e/fG3bt3sWrVqgKfmJyUlIT4+Hjcvn0be/fuRbdu3bBx40YsX75cOieoUqVK2Lt3L44fP47Lly/js88+Q0JCgsZ63NzccOLECdy6dUs6vBcQEIBHjx6hV69eOHnyJG7cuIE9e/Zg0KBB+YYIe3t71KlTB0ePHs23ZhsbG8TFxWH//v15zq9UqRI6deqEoUOH4ujRozh//jz69u2LsmXLolOnTgXqS842XbhwAdHR0Xjw4EGeI3H5+eeff6BUKuHt7V3g1xCVFAw7RCWcSqWCSqXKc56BgQE2b96M06dPo3r16ggMDMS8efM0ljEyMsKSJUvw008/wdnZWfrlOnjwYAwYMAD9+/dHs2bNUKFCBekycm2ULVsW06dPx8SJE+Ho6CgddgMAKysr+Pv7w9LSssA3wxs0aBDKlCkDDw8PDB8+HJaWloiIiEDv3r2lZSZNmoQ6derA19cXzZs3h5OTU671jxs3DoaGhvD09IS9vT1iYmLg7OyMY8eOISsrC23atIGXlxfGjBkDa2trGBjk/9/lp59++sYb8llbW7/2kN/atWtRt25ddOjQAd7e3hBCYNeuXbkOXb3O0KFDUaVKFdSrVw/29vYal7y/yaZNm9CnT583ntdEVBIpREEP+BIRFYJWrVqhWrVqJfqGds+fP0eVKlXw22+/lciRkQcPHqBKlSo4deqUdN4TkZzwBGUi0ovHjx/j0KFDOHToEJYtW6bvct6JmZkZ1q9f/9qbDxZnt27dwrJlyxh0SLY4skNEeuHm5obHjx9j8uTJGvfEISLSNYYdIiIikjWeoExERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREssawQ0RERLLGsENERESyxrBDREREsvb/UXDAZqezAmoAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "df_loans['maturityMonth'] = df_loans['maturityDate'].dt.to_period('M')\n",
    "loan_count_by_month = df_loans['maturityMonth'].value_counts().sort_index()\n",
    "plt.bar(loan_count_by_month.index.astype(str), loan_count_by_month.values)\n",
    "plt.xlabel('Maturity Date (Month)')\n",
    "plt.ylabel('Number of Loans')\n",
    "plt.title('Number of Loans Maturing by Month')\n",
    "plt.xticks(rotation=45)\n",
    "plt.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4bef4ae7-0acf-4ef4-9558-d33e19304cfd",
   "metadata": {},
   "source": [
    "# Part3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "fb30c99e-a3a5-405f-b036-92b2c2b32279",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Weighted Average Life:\n",
      "0        94\n",
      "1        49\n",
      "2        49\n",
      "3        49\n",
      "4        49\n",
      "       ... \n",
      "1381     74\n",
      "1382     87\n",
      "1383     87\n",
      "1384     51\n",
      "1385    155\n",
      "Name: weighted_averageLife, Length: 1386, dtype: int64\n",
      "Calculated Weighted Average Life: 66.62579343754138\n"
     ]
    }
   ],
   "source": [
    "df_loans['weighted_averageLife'] = (pd.to_datetime(df_loans['maturityDate']) - pd.to_datetime('now')).dt.days\n",
    "\n",
    "df_loans['weighted_averageLife'] = pd.to_numeric(df_loans['weighted_averageLife'], errors='coerce')\n",
    "df_loans['currentBalance'] = pd.to_numeric(df_loans['currentBalance'], errors='coerce')\n",
    "\n",
    "print(\"Weighted Average Life:\")\n",
    "print(df_loans['weighted_averageLife'])\n",
    "\n",
    "weighted_averageLife = (df_loans['weighted_averageLife'] * df_loans['currentBalance']).sum() / df_loans['currentBalance'].sum()\n",
    "print(\"Calculated Weighted Average Life:\", weighted_averageLife)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f0e2c85a-5d70-4810-a885-ca2c26ed894c",
   "metadata": {},
   "source": [
    "# Part4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2484cbd0-f956-492b-b42c-5c87b6d82874",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Average Margin by Industry:\n",
      "industryName\n",
      "Aerospace and Defense                        3.610022\n",
      "Automotive                                   3.842820\n",
      "Banking, Finance, Insurance & Real Estate    3.641331\n",
      "Beverage, Food & Tobacco                     3.317848\n",
      "Capital Equipment                            3.725562\n",
      "Chemicals, Plastics & Rubber                 3.999278\n",
      "Construction & Building                      3.452604\n",
      "Consumer goods: Durable                      3.460558\n",
      "Consumer goods: Non-durable                  3.111842\n",
      "Containers, Packaging & Glass                3.931057\n",
      "Energy: Electricity                          4.079532\n",
      "Energy: Oil & Gas                            4.714138\n",
      "Environmental Industries                     3.977540\n",
      "Healthcare & Pharmaceuticals                 3.814443\n",
      "High Tech Industries                         3.856261\n",
      "Hotel, Gaming & Leisure                      3.448855\n",
      "Media: Advertising, Printing & Publishing    3.869200\n",
      "Media: Broadcasting & Subscription           3.103029\n",
      "Media: Diversified & Production              3.611146\n",
      "Metals & Mining                              3.750000\n",
      "Retail                                       2.834960\n",
      "Services: Business                           3.967285\n",
      "Services: Consumer                           3.868990\n",
      "Telecommunications                           3.499144\n",
      "Transportation: Cargo                        4.110422\n",
      "Transportation: Consumer                     3.396730\n",
      "Utilities: Electric                          3.546057\n",
      "Utilities: Oil and Gas                       3.364480\n",
      "Wholesale                                    3.757740\n",
      "Name: margin, dtype: float64\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<>:1: SyntaxWarning: invalid escape sequence '\\d'\n",
      "<>:1: SyntaxWarning: invalid escape sequence '\\d'\n",
      "C:\\Users\\harsh\\AppData\\Local\\Temp\\ipykernel_21228\\91262422.py:1: SyntaxWarning: invalid escape sequence '\\d'\n",
      "  df_loans['margin'] = df_loans['adjustableRateFormula'].str.extract('(\\d+\\.\\d+)', expand=False).astype(float)\n"
     ]
    }
   ],
   "source": [
    "df_loans['margin'] = df_loans['adjustableRateFormula'].str.extract('(\\d+\\.\\d+)', expand=False).astype(float)\n",
    "average_margin_by_industry = df_loans.groupby('industryName')['margin'].mean()\n",
    "print('Average Margin by Industry:')\n",
    "print(average_margin_by_industry)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "917f4c9d-d5b0-4de8-a477-ed1fc6e96a81",
   "metadata": {},
   "source": [
    "# Part5 (a)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "2af57997-c1d1-4d45-908c-229a68e93cd5",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "b. Second highest loan count country: Netherlands\n"
     ]
    }
   ],
   "source": [
    "country_loans_count = df_loans['country'].value_counts()\n",
    "second_highest_loan_count_country = country_loans_count.index[1]\n",
    "print(f'b. Second highest loan count country: {second_highest_loan_count_country}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "57c42f74-a6e6-47e3-9432-1da182cc7851",
   "metadata": {},
   "source": [
    "# Part5 (b)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a8a4bc4e-973a-4df8-bfb9-6c966196ec83",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "b. Second highest loan balance country: Canada\n"
     ]
    }
   ],
   "source": [
    "country_loan_balance = df_loans.groupby('country')['currentBalance'].sum()\n",
    "second_highest_loan_balance_country = country_loan_balance.index[1]\n",
    "print(f'b. Second highest loan balance country: {second_highest_loan_balance_country}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fbe96e35-9585-452c-b3d4-836ed35dc823",
   "metadata": {},
   "source": [
    "# Part6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "4fe6517b-5ffe-43fc-9dcf-a2ffaefaa8b4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Percentage of Second Lien loans with grossCoupon > 11.0: 70.00%\n"
     ]
    }
   ],
   "source": [
    "second_lien_loans = df_loans[df_loans['priority'] == 'Second Lien']\n",
    "percentage_high_gross_coupon = (second_lien_loans['grossCoupon'] > 11.0).mean() * 100\n",
    "print(f'Percentage of Second Lien loans with grossCoupon > 11.0: {percentage_high_gross_coupon:.2f}%')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5972dce8-0a27-4bff-8827-9f75b951c96a",
   "metadata": {},
   "source": [
    "# Part7"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "d3efe47d-5a7e-45cb-8188-59caac024160",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "\"moody'sRating\"",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3791\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3790\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3791\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_engine\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcasted_key\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3792\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:152\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:181\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:7080\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:7088\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: \"moody'sRating\"",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[31], line 8\u001b[0m\n\u001b[0;32m      1\u001b[0m df_loans \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mratings.csv\u001b[39m\u001b[38;5;124m'\u001b[39m) \n\u001b[0;32m      3\u001b[0m rating_mapping \u001b[38;5;241m=\u001b[39m {\n\u001b[0;32m      4\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mA\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m1\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mB\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m2\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mC\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m3\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mD\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m4\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mE\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m5\u001b[39m,\n\u001b[0;32m      5\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m1\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m0\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m2\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m1\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m3\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m2\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m4\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m3\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m5\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m4\u001b[39m,\n\u001b[0;32m      6\u001b[0m }\n\u001b[1;32m----> 8\u001b[0m df_loans[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mminRatingCode\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[43mdf_loans\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mapply\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m      9\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;28;43;01mlambda\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43mrow\u001b[49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[43mrating_mapping\u001b[49m\u001b[43m[\u001b[49m\u001b[43mrow\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mmoody\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43msRating\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;241;43m0\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m]\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m10\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m+\u001b[39;49m\u001b[43m \u001b[49m\u001b[43mrating_mapping\u001b[49m\u001b[43m[\u001b[49m\u001b[43mrow\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43ms&pRating\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m[\u001b[49m\u001b[43m:\u001b[49m\u001b[38;5;241;43m-\u001b[39;49m\u001b[38;5;241;43m1\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maxis\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m1\u001b[39;49m\n\u001b[0;32m     10\u001b[0m \u001b[43m)\u001b[49m\n\u001b[0;32m     12\u001b[0m \u001b[38;5;28mprint\u001b[39m(df_loans[[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmoody\u001b[39m\u001b[38;5;130;01m\\'\u001b[39;00m\u001b[38;5;124msRating\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124ms&pRating\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mminRatingCode\u001b[39m\u001b[38;5;124m'\u001b[39m]])\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\frame.py:10034\u001b[0m, in \u001b[0;36mDataFrame.apply\u001b[1;34m(self, func, axis, raw, result_type, args, by_row, **kwargs)\u001b[0m\n\u001b[0;32m  10022\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mapply\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m frame_apply\n\u001b[0;32m  10024\u001b[0m op \u001b[38;5;241m=\u001b[39m frame_apply(\n\u001b[0;32m  10025\u001b[0m     \u001b[38;5;28mself\u001b[39m,\n\u001b[0;32m  10026\u001b[0m     func\u001b[38;5;241m=\u001b[39mfunc,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m  10032\u001b[0m     kwargs\u001b[38;5;241m=\u001b[39mkwargs,\n\u001b[0;32m  10033\u001b[0m )\n\u001b[1;32m> 10034\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mop\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mapply\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[38;5;241m.\u001b[39m__finalize__(\u001b[38;5;28mself\u001b[39m, method\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mapply\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\apply.py:837\u001b[0m, in \u001b[0;36mFrameApply.apply\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    834\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mraw:\n\u001b[0;32m    835\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mapply_raw()\n\u001b[1;32m--> 837\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mapply_standard\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\apply.py:965\u001b[0m, in \u001b[0;36mFrameApply.apply_standard\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    964\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mapply_standard\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m--> 965\u001b[0m     results, res_index \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mapply_series_generator\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    967\u001b[0m     \u001b[38;5;66;03m# wrap results\u001b[39;00m\n\u001b[0;32m    968\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mwrap_results(results, res_index)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\apply.py:981\u001b[0m, in \u001b[0;36mFrameApply.apply_series_generator\u001b[1;34m(self)\u001b[0m\n\u001b[0;32m    978\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m option_context(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmode.chained_assignment\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[0;32m    979\u001b[0m     \u001b[38;5;28;01mfor\u001b[39;00m i, v \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28menumerate\u001b[39m(series_gen):\n\u001b[0;32m    980\u001b[0m         \u001b[38;5;66;03m# ignore SettingWithCopy here in case the user mutates\u001b[39;00m\n\u001b[1;32m--> 981\u001b[0m         results[i] \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mv\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    982\u001b[0m         \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(results[i], ABCSeries):\n\u001b[0;32m    983\u001b[0m             \u001b[38;5;66;03m# If we have a view on v, we need to make a copy because\u001b[39;00m\n\u001b[0;32m    984\u001b[0m             \u001b[38;5;66;03m#  series_generator will swap out the underlying data\u001b[39;00m\n\u001b[0;32m    985\u001b[0m             results[i] \u001b[38;5;241m=\u001b[39m results[i]\u001b[38;5;241m.\u001b[39mcopy(deep\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m)\n",
      "Cell \u001b[1;32mIn[31], line 9\u001b[0m, in \u001b[0;36m<lambda>\u001b[1;34m(row)\u001b[0m\n\u001b[0;32m      1\u001b[0m df_loans \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mratings.csv\u001b[39m\u001b[38;5;124m'\u001b[39m) \n\u001b[0;32m      3\u001b[0m rating_mapping \u001b[38;5;241m=\u001b[39m {\n\u001b[0;32m      4\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mA\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m1\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mB\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m2\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mC\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m3\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mD\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m4\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mE\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m5\u001b[39m,\n\u001b[0;32m      5\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m1\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m0\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m2\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m1\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m3\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m2\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m4\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m3\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m5\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m4\u001b[39m,\n\u001b[0;32m      6\u001b[0m }\n\u001b[0;32m      8\u001b[0m df_loans[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mminRatingCode\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m df_loans\u001b[38;5;241m.\u001b[39mapply(\n\u001b[1;32m----> 9\u001b[0m     \u001b[38;5;28;01mlambda\u001b[39;00m row: rating_mapping[\u001b[43mrow\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mmoody\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43msRating\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m]\u001b[49m[\u001b[38;5;241m0\u001b[39m]] \u001b[38;5;241m*\u001b[39m \u001b[38;5;241m10\u001b[39m \u001b[38;5;241m+\u001b[39m rating_mapping[row[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124ms&pRating\u001b[39m\u001b[38;5;124m\"\u001b[39m][:\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m]], axis\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1\u001b[39m\n\u001b[0;32m     10\u001b[0m )\n\u001b[0;32m     12\u001b[0m \u001b[38;5;28mprint\u001b[39m(df_loans[[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmoody\u001b[39m\u001b[38;5;130;01m\\'\u001b[39;00m\u001b[38;5;124msRating\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124ms&pRating\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mminRatingCode\u001b[39m\u001b[38;5;124m'\u001b[39m]])\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\series.py:1040\u001b[0m, in \u001b[0;36mSeries.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   1037\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_values[key]\n\u001b[0;32m   1039\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m key_is_scalar:\n\u001b[1;32m-> 1040\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_get_value\u001b[49m\u001b[43m(\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1042\u001b[0m \u001b[38;5;66;03m# Convert generator to list before going through hashable part\u001b[39;00m\n\u001b[0;32m   1043\u001b[0m \u001b[38;5;66;03m# (We will iterate through the generator there to check for slices)\u001b[39;00m\n\u001b[0;32m   1044\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_iterator(key):\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\series.py:1156\u001b[0m, in \u001b[0;36mSeries._get_value\u001b[1;34m(self, label, takeable)\u001b[0m\n\u001b[0;32m   1153\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_values[label]\n\u001b[0;32m   1155\u001b[0m \u001b[38;5;66;03m# Similar to Index.get_value, but we do not fall back to positional\u001b[39;00m\n\u001b[1;32m-> 1156\u001b[0m loc \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mindex\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mlabel\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1158\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(loc):\n\u001b[0;32m   1159\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_values[loc]\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3798\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3793\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3794\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3795\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3796\u001b[0m     ):\n\u001b[0;32m   3797\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3798\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3799\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3800\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3801\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3802\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3803\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: \"moody'sRating\""
     ]
    }
   ],
   "source": [
    "\n",
    "df_loans = pd.read_csv('ratings.csv') \n",
    "\n",
    "rating_mapping = {\n",
    "    'A': 1, 'B': 2, 'C': 3, 'D': 4, 'E': 5,\n",
    "    '1': 0, '2': 1, '3': 2, '4': 3, '5': 4,\n",
    "}\n",
    "\n",
    "df_loans['minRatingCode'] = df_loans.apply(\n",
    "    lambda row: rating_mapping[row[\"moody'sRating\"][0]] * 10 + rating_mapping[row[\"s&pRating\"][:-1]], axis=1\n",
    ")\n",
    "\n",
    "print(df_loans[['moody\\'sRating', 's&pRating', 'minRatingCode']])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6893fda7-7296-447c-b18b-636f5cf8bce8",
   "metadata": {},
   "source": [
    "# Part8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "1e4a8c3e-cec1-42da-b2bf-1ecb13896414",
   "metadata": {},
   "outputs": [
    {
     "ename": "KeyError",
     "evalue": "'amortizationSchedule'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3791\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3790\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[1;32m-> 3791\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_engine\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcasted_key\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3792\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m err:\n",
      "File \u001b[1;32mindex.pyx:152\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mindex.pyx:181\u001b[0m, in \u001b[0;36mpandas._libs.index.IndexEngine.get_loc\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:7080\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "File \u001b[1;32mpandas\\_libs\\hashtable_class_helper.pxi:7088\u001b[0m, in \u001b[0;36mpandas._libs.hashtable.PyObjectHashTable.get_item\u001b[1;34m()\u001b[0m\n",
      "\u001b[1;31mKeyError\u001b[0m: 'amortizationSchedule'",
      "\nThe above exception was the direct cause of the following exception:\n",
      "\u001b[1;31mKeyError\u001b[0m                                  Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[32], line 10\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[38;5;66;03m# df_loans['principalDue2024'] = df_loans['amortizationSchedule'].apply(\u001b[39;00m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;66;03m#     lambda x: float(re.search(r'([\\d,]+)\\s+@.+2024', x).group(1).replace(',', '')) if '2024' in x else 0\u001b[39;00m\n\u001b[0;32m      3\u001b[0m \u001b[38;5;66;03m# )\u001b[39;00m\n\u001b[0;32m      4\u001b[0m \u001b[38;5;66;03m# total_principal_due_2024 = df_loans['principalDue2024'].sum()\u001b[39;00m\n\u001b[0;32m      5\u001b[0m \u001b[38;5;66;03m# print(f'Total Principal Due in 2024: ${total_principal_due_2024:,.2f}')\u001b[39;00m\n\u001b[1;32m---> 10\u001b[0m df_loans[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprincipalDue2024\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[43mdf_loans\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mamortizationSchedule\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[38;5;241m.\u001b[39mapply(\n\u001b[0;32m     11\u001b[0m     \u001b[38;5;28;01mlambda\u001b[39;00m x: \u001b[38;5;28mfloat\u001b[39m(re\u001b[38;5;241m.\u001b[39msearch(\u001b[38;5;124mr\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m([\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124md,]+)\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124ms+@.+2024\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;28mstr\u001b[39m(x))\u001b[38;5;241m.\u001b[39mgroup(\u001b[38;5;241m1\u001b[39m)\u001b[38;5;241m.\u001b[39mreplace(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m,\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)) \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m2024\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28mstr\u001b[39m(x) \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;241m0\u001b[39m\n\u001b[0;32m     12\u001b[0m )\n\u001b[0;32m     14\u001b[0m total_principal_due_2024 \u001b[38;5;241m=\u001b[39m df_loans[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mprincipalDue2024\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39msum()\n\u001b[0;32m     15\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mTotal Principal Due in 2024: $\u001b[39m\u001b[38;5;132;01m{\u001b[39;00mtotal_principal_due_2024\u001b[38;5;132;01m:\u001b[39;00m\u001b[38;5;124m,.2f\u001b[39m\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\frame.py:3893\u001b[0m, in \u001b[0;36mDataFrame.__getitem__\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3891\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcolumns\u001b[38;5;241m.\u001b[39mnlevels \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[0;32m   3892\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_getitem_multilevel(key)\n\u001b[1;32m-> 3893\u001b[0m indexer \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcolumns\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget_loc\u001b[49m\u001b[43m(\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   3894\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m is_integer(indexer):\n\u001b[0;32m   3895\u001b[0m     indexer \u001b[38;5;241m=\u001b[39m [indexer]\n",
      "File \u001b[1;32m~\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\pandas\\core\\indexes\\base.py:3798\u001b[0m, in \u001b[0;36mIndex.get_loc\u001b[1;34m(self, key)\u001b[0m\n\u001b[0;32m   3793\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(casted_key, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;129;01mor\u001b[39;00m (\n\u001b[0;32m   3794\u001b[0m         \u001b[38;5;28misinstance\u001b[39m(casted_key, abc\u001b[38;5;241m.\u001b[39mIterable)\n\u001b[0;32m   3795\u001b[0m         \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28many\u001b[39m(\u001b[38;5;28misinstance\u001b[39m(x, \u001b[38;5;28mslice\u001b[39m) \u001b[38;5;28;01mfor\u001b[39;00m x \u001b[38;5;129;01min\u001b[39;00m casted_key)\n\u001b[0;32m   3796\u001b[0m     ):\n\u001b[0;32m   3797\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m InvalidIndexError(key)\n\u001b[1;32m-> 3798\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m(key) \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01merr\u001b[39;00m\n\u001b[0;32m   3799\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m:\n\u001b[0;32m   3800\u001b[0m     \u001b[38;5;66;03m# If we have a listlike key, _check_indexing_error will raise\u001b[39;00m\n\u001b[0;32m   3801\u001b[0m     \u001b[38;5;66;03m#  InvalidIndexError. Otherwise we fall through and re-raise\u001b[39;00m\n\u001b[0;32m   3802\u001b[0m     \u001b[38;5;66;03m#  the TypeError.\u001b[39;00m\n\u001b[0;32m   3803\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_check_indexing_error(key)\n",
      "\u001b[1;31mKeyError\u001b[0m: 'amortizationSchedule'"
     ]
    }
   ],
   "source": [
    "\n",
    "df_loans['principalDue2024'] = df_loans['amortizationSchedule'].apply(\n",
    "    lambda x: float(re.search(r'([\\d,]+)\\s+@.+2024', str(x)).group(1).replace(',', '')) if '2024' in str(x) else 0\n",
    ")\n",
    "\n",
    "total_principal_due_2024 = df_loans['principalDue2024'].sum()\n",
    "print(f'Total Principal Due in 2024: ${total_principal_due_2024:,.2f}')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3c787b2a-a4a9-4e99-8430-7ba532eac76d",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
